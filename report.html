{% extends 'layout.html' %}

{% block content %}
<h2 class="mb-4">Financial Analysis and Reports</h2>

<div class="row">
    <div class="col-md-6 mb-4">
        <div class="card shadow-sm p-3">
            <h4 class="card-title">Top 5 Spending Categories (Current Month)</h4>
            <div class="list-group">
                {% for item in category_spending %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    {{ item.category }}
                    <span class="badge bg-danger rounded-pill">₹ {{ "{:,.2f}".format(item.total_spent) }}</span>
                </li>
                {% else %}
                <li class="list-group-item text-muted">No expenses logged this month to analyze.</li>
                {% endfor %}
            </div>
            <small class="mt-2 text-muted">*This section helps identify major spending areas.</small>
        </div>
        
    </div>

    <div class="col-md-6 mb-4">
        <div class="card shadow-sm p-3">
            <h4 class="card-title">Monthly Income vs. Expense Trend</h4>
            <div class="table-responsive">
                <table class="table table-bordered table-sm">
                    <thead class="table-dark">
                        <tr>
                            <th>Month</th>
                            <th class="text-success">Income (₹)</th>
                            <th class="text-danger">Expense (₹)</th>
                            <th>Net (₹)</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for month in monthly_data %}
                        <tr>
                            <td>**{{ month.month_year }}**</td>
                            <td class="text-success">{{ "{:,.2f}".format(month.total_income) }}</td>
                            <td class="text-danger">{{ "{:,.2f}".format(month.total_expense) }}</td>
                            <td class="fw-bold {% if (month.total_income - month.total_expense) >= 0 %}text-primary{% else %}text-danger{% endif %}">
                                {{ "{:,.2f}".format(month.total_income - month.total_expense) }}
                            </td>
                        </tr>
                        {% else %}
                        <tr>
                            <td colspan="4" class="text-center text-muted">No data yet to generate a trend report.</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

{% endblock %}